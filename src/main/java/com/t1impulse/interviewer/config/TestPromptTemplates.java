package com.t1impulse.interviewer.config;

import java.util.EnumMap;
import java.util.Map;

public final class TestPromptTemplates {

    public record PromptTemplate(String model, String system, String userTemplate, double temperature, double topP,
                                 int maxTokens) {
        
        /**
         * Возвращает user prompt с указанным количеством вопросов
         */
        public String getUserPrompt(int questionCount) {
            return userTemplate
                    .replace("{QUESTION_COUNT}", String.valueOf(questionCount))
                    .replace("{QUESTION_COUNT_RANGE}", "от 1 до " + questionCount);
        }
    }

    private static final Map<TestTopic, PromptTemplate> TEMPLATES = new EnumMap<>(TestTopic.class);

    static {
        TEMPLATES.put(TestTopic.MACHINE_LEARNING, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по машинному обучению на уровне хорошего университетского курса. Твоя задача — генерировать тесты по классическому машинному обучению.
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: классическое машинное обучение (без глубокого погружения в нейросети). Освети:
                        – базовые понятия (supervised / unsupervised / reinforcement learning);
                        – регрессию и классификацию;
                        – переобучение, регуляризацию, кросс-валидацию;
                        – основные алгоритмы (линейная/логистическая регрессия, k-NN, деревья решений, ансамбли — bagging/boosting, Random Forest, SVM, k-means);
                        – метрики качества (accuracy, precision, recall, F1, ROC-AUC, confusion matrix);
                        – практические вещи: train/validation/test split, масштабирование признаков, one-hot encoding, градиентный спуск.

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй код и формулы LaTeX — только текст.
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы студент, прошедший вводный курс по ML, мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));

        TEMPLATES.put(TestTopic.BACKEND, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по backend-разработке на Java с использованием Spring. Твоя задача — генерировать тесты по backend-разработке на уровне хорошего университетского курса и начального коммерческого опыта.
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: backend-разработка на Java и Spring. Освети:
                        – основы Java (классы, интерфейсы, коллекции, исключения);
                        – основы HTTP и REST;
                        – Spring Core (контейнер, внедрение зависимостей, бины);
                        – Spring MVC / Web;
                        – работа с базой данных: JDBC, JPA/Hibernate, сущности и репозитории;
                        – базовые вещи по безопасности (аутентификация и авторизация в общих словах);
                        – конфигурация через application.properties / YAML, профили.

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй код и формулы LaTeX — только текст (описывай код словами).
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы junior-разработчик, прошедший курс по Java/Spring, мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));

        TEMPLATES.put(TestTopic.FRONTEND, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по frontend-разработке. Твоя задача — генерировать тесты по современному frontend-стеку (JavaScript/TypeScript, HTML/CSS, React).
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: frontend-разработка. Освети:
                        – основы HTML и семантическая разметка;
                        – основы CSS (селекторы, box-model, flex и grid на уровне понятий);
                        – базовый JavaScript: типы, области видимости, функции, промисы, async/await;
                        – основы TypeScript: типы, интерфейсы, преимущества типизации;
                        – React: компоненты, пропсы, состояние (state), эффекты (useEffect) на уровне понятий;
                        – базовое понимание SPA, маршрутизации и работы с API (fetch/axios).

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй код и формулы LaTeX — только текст (описывай поведение кода словами).
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы junior-frontend, прошедший курс по JS/React, мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));

        TEMPLATES.put(TestTopic.ALGORITHMS, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по алгоритмам и структурам данных. Твоя задача — генерировать тесты по базовым алгоритмам и структурам данных.
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: алгоритмы и структуры данных. Освети:
                        – базовые структуры данных: массив, список, стек, очередь, хэш-таблица, дерево;
                        – асимптотическая сложность (Big-O) на уровне идей;
                        – базовые алгоритмы сортировки (пузырьковая сортировка, быстрая сортировка, сортировка слиянием на уровне концепции);
                        – поиск в массиве и дереве (линейный поиск, бинарный поиск на уровне идей);
                        – графы: вершины, ребра, взвешенные графы, поиск в ширину и глубину на уровне понятий.

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй код и формулы LaTeX — только текст.
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы студент, прошедший курс по алгоритмам, мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));

        TEMPLATES.put(TestTopic.DATA_SCIENCE, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по Data Science и аналитике данных начального уровня. Твоя задача — генерировать тесты по базовой статистике, SQL и Python для анализа данных.
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: Data Science и аналитика. Освети:
                        – базовую описательную статистику: среднее, медиана, дисперсия, выборка и генеральная совокупность;
                        – базовые понятия вероятности (событие, вероятность, независимость на уровне идей);
                        – SQL: SELECT, WHERE, JOIN, GROUP BY, агрегатные функции;
                        – Python для анализа данных на уровне понятий: что такое библиотека pandas и для чего она используется;
                        – базовые типы визуализации: гистограмма, линейный график, scatter plot на уровне понятий.

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй код и формулы LaTeX — только текст.
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы начинающий специалист по Data Science или аналитик после вводного курса мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));

        TEMPLATES.put(TestTopic.DEVOPS, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по DevOps и инфраструктуре. Твоя задача — генерировать тесты по базовым DevOps-концепциям.
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: DevOps и инфраструктура. Освети:
                        – базовые команды Linux и понимание процессов на уровне идей;
                        – контейнеризация: базовые понятия Docker (образ, контейнер, Dockerfile на уровне идей);
                        – docker-compose на уровне понятий (несколько сервисов, сети, тома);
                        – CI/CD на уровне понятий: что такое pipeline, build, test, deploy;
                        – базовые идеи мониторинга и логирования (разница между метриками и логами на уровне понятий);
                        – разница между staging и production на уровне идей.

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй код и формулы LaTeX — только текст.
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы начинающий DevOps-инженер или инженер сопровождения после вводного курса мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));

        TEMPLATES.put(TestTopic.OOP, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по объектно-ориентированному программированию и шаблонам проектирования. Твоя задача — генерировать тесты по ООП и базовым шаблонам проектирования.
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: объектно-ориентированное программирование и шаблоны проектирования. Освети:
                        – базовые принципы ООП: инкапсуляция, наследование, полиморфизм, абстракция;
                        – различие класса и объекта на уровне понятий;
                        – понятие интерфейса и абстрактного класса;
                        – базовые шаблоны проектирования: Singleton, Factory Method, Strategy, Observer на уровне идей;
                        – принципы SOLID на уровне понятий.

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй код и формулы LaTeX — только текст (описывай поведение кода словами).
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы разработчик после курса по ООП и паттернам мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));

        TEMPLATES.put(TestTopic.SQL, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по реляционным базам данных и SQL. Твоя задача — генерировать тесты по базам данных и SQL.
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: реляционные базы данных и SQL. Освети:
                        – основные понятия: таблица, строка, столбец, первичный ключ, внешний ключ;
                        – нормализация на уровне понятий (1НФ, 2НФ, 3НФ без формальных определений);
                        – базовые SQL-запросы: SELECT, INSERT, UPDATE, DELETE;
                        – фильтрация и сортировка: WHERE, ORDER BY, LIMIT;
                        – соединения таблиц: INNER JOIN, LEFT JOIN на уровне идей;
                        – агрегатные функции и группировка: COUNT, SUM, AVG, GROUP BY, HAVING на уровне понятий.

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй код и формулы LaTeX — только текст (SQL описывай словами, без реальных запросов).
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы разработчик или аналитик после курса по БД и SQL мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));

        TEMPLATES.put(TestTopic.NETWORKS, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по компьютерным сетям. Твоя задача — генерировать тесты по базовым понятиям сетей и протоколов.
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: компьютерные сети. Освети:
                        – модель OSI на уровне понятий (основные уровни и их смысл);
                        – разницу между TCP и UDP на уровне идей;
                        – IP-адресация (IPv4, маска сети, порт) на уровне понятий;
                        – базовые протоколы: HTTP, DNS, DHCP на уровне идей;
                        – разницу между switch и router на уровне понятий;
                        – понятия LAN и WAN на уровне идей.

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй код и формулы LaTeX — только текст.
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы студент после курса по сетям мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));

        TEMPLATES.put(TestTopic.INFOSEC, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по основам информационной безопасности. Твоя задача — генерировать тесты по базовым понятиям информационной безопасности.
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: основы информационной безопасности. Освети:
                        – базовые цели ИБ: конфиденциальность, целостность, доступность на уровне понятий;
                        – отличия аутентификации, авторизации и аудитирования на уровне идей;
                        – базовые типы атак: phishing, brute force, SQL injection на уровне понятий;
                        – роль шифрования на уровне идей (что это и зачем нужно, без математики);
                        – безопасная работа с паролями на уровне идей (длина, уникальность, хранение);
                        – принцип минимальных привилегий на уровне понятий.

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй код и формулы LaTeX — только текст.
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы специалист начального уровня по ИБ или разработчик, прошедший курс по основам безопасности, мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));

        TEMPLATES.put(TestTopic.CPP, new PromptTemplate(
                "qwen3-32b-awq",
                """
                        Ты — строгий и аккуратный преподаватель по языку C++ на уровне хорошего университетского курса и начального коммерческого опыта. Твоя задача — генерировать тесты по современному C++ (на уровне C++11/C++14) для начинающих разработчиков.
                        """,
                """
                        Требования к тесту:
                        Сделай ровно {QUESTION_COUNT} вопросов.
                        Тема: язык C++ и базовое программирование. Освети:
                        – базовый синтаксис: типы данных, переменные, операторы, условные конструкции и циклы на уровне понятий;
                        – функции: передача параметров по значению и по ссылке, возвращаемые значения на уровне идей;
                        – основы работы с памятью: стек и куча на уровне понятий, new/delete на уровне идей;
                        – основы ООП в C++: классы, конструкторы, деструктор, инкапсуляция на уровне понятий;
                        – стандартные контейнеры и алгоритмы STL на уровне идей (vector, string, базовые алгоритмы вроде sort);
                        – базовое понимание указателей и ссылок на уровне понятий.

                        Формат каждого вопроса:
                        – сам вопрос;
                        – 4 варианта ответа, помеченные «a)», «b)», «c)», «d)»;
                        – ровно один вариант должен быть правильным.
                        После каждого вопроса отдельной строкой укажи правильный ответ в формате: «Ответ: c)».
                        Без пояснений и решений.
                        Не используй реальный код C++ — описывай поведение и конструкции словами.
                        Пиши все на русском языке.
                        Уровень сложности: средний — так, чтобы студент, прошедший вводный курс по C++, мог решить тест без интернета, но не «на автомате».

                        Формат вывода:
                        Пронумеруй вопросы {QUESTION_COUNT_RANGE}.
                        Для каждого вопроса сначала текст вопроса и варианты ответов, затем строка с правильным вариантом.
                        Никаких лишних комментариев до и после теста — только сам тест.
                        """,
                0.4, 0.9, 2000));
    }

    private TestPromptTemplates() {
    }

    public static PromptTemplate get(TestTopic topic) {
        return TEMPLATES.get(topic);
    }
}

